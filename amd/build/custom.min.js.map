{"version":3,"sources":["../src/custom.js"],"names":["define","$","initialise","document","ready","mainregion","addregion","strings","save","update","req","preview","title","message","on","e","preventDefault","senddata","call","purpose","tableaction","blockid","eattr","closest","attr","dattr","find","value","refreshRequired","savebutton","addClass","val","callpath","M","cfg","wwwroot","sesskey","post","fail","console","error","done","data","JSON","parse","parseInt","fadeOut","remove","clearForm","refreshPreview","i","hasOwnProperty","form","prepend","affectelement","prop","reloadPreview","rattr","pdattr","status","checkRequired","show","serialize","responseJSON","sfield","insertAfter","nextSibling","hide","setTimeout","load","length","innerHTML","alerttype","previewalert","removeClass","util","image_url","checked","previewelem","previewdom","prependTo","slideDown","disselopt","opt","reset","init","always","append"],"mappings":"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","sourcesContent":["/* eslint no-console: [\"error\", { allow: [\"error\"] }], max-nested-callbacks: [\"error\", 7] */\n/**\n * @package    block_advnotifications\n * @copyright  2019 onwards LearningWorks Ltd {@link https://learningworks.co.nz/}\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author     Zander Potgieter <zander.potgieter@learningworks.co.nz>\n */\n\n/**\n * @module block_advnotifications/custom\n */\ndefine(['jquery'], function($) {\n    // JQuery is available via $.\n\n    return {\n        initialise: function() {\n            // Module initialised.\n            $(document).ready(function() {\n                // Commonly (multiple times) used elements.\n                var mainregion = $('#region-main');\n                var addregion = $('#add_notification_wrapper_id');\n                var strings = {\n                    save: 'Save',\n                    update: 'Update',\n                    req: 'Required...',\n                    preview: 'Preview',\n                    title: 'Title',\n                    message: 'Message'\n                };\n\n                // MANAGING NOTIFICATIONS.\n                mainregion.on('click', '.notifications_table tr > td > form > button[type=submit]', function(e) {\n                    e.preventDefault();\n                    var senddata = {}; // Data Object.\n                    senddata.call = 'ajax';\n                    senddata.purpose = '';\n                    senddata.tableaction = '';\n                    senddata.blockid = '';\n\n                    // Check if user wants to edit/delete.\n                    var eattr = $(this).closest('form').attr('data-edit');\n                    var dattr = $(this).closest('form').attr('data-delete');\n                    senddata.blockid = $(this).closest('form').find('[name=blockid]')[0].value;\n                    refreshRequired();\n\n                    // Check if anchor element has attribute, retrieved from above.\n                    if (typeof eattr !== typeof undefined && eattr !== false) {\n                        senddata.purpose = 'edit';\n                        senddata.tableaction = eattr;\n\n                        var savebutton = $('#add_notification_save');\n                        savebutton.addClass('update');\n                        savebutton.val(strings.update);\n                    } else if (typeof dattr !== typeof undefined && dattr !== false) {\n                        senddata.purpose = 'delete';\n                        senddata.tableaction = dattr;\n                    }\n\n                    var callpath = M.cfg.wwwroot + \"/blocks/advnotifications/pages/process.php?sesskey=\" + M.cfg.sesskey;\n\n                    // Perform tableaction.\n                    $.post(callpath, senddata).fail(function() {\n                        console.error(\"No 'manage' response received.\");\n                    }).done(function(data) {\n                        data = JSON.parse(data);\n\n                        // User deleted/edited notification.\n                        if (parseInt(data.done, 10) > 0) {\n                            $('#tr' + senddata.purpose + data.done).closest(\"tr\").fadeOut(250, function() {\n                                $(this).remove();\n                                clearForm();\n                                refreshPreview();\n                            });\n                        } else if (senddata.purpose === \"edit\") {\n                            for (var i in data) {\n                                if (data.hasOwnProperty(i)) {\n\n                                    // Need this for updating.\n                                    if (i === \"id\") {\n                                        var form = $('#add_notification_form');\n\n                                        // Because we're doing a standard submit, we need extra inputs to pass params.\n                                        // But first, remove old hidden inputs.\n                                        $('#add_notification_id').remove();\n                                        form.prepend(\n                                            '<input type=\"hidden\" id=\"add_notification_id\" name=\"id\" value=\"' + data[i] + '\"/>'\n                                        );\n\n                                        $('#add_notification_purpose').val('update');\n                                    }\n\n                                    var affectelement = $('#add_notification_wrapper_id').find('#add_notification_' + i);\n\n                                    // Check whether checkboxes should be checked or not.\n                                    // We also don't assign a value to checkbox input fields.\n                                    if (\n                                        (\n                                            i === 'enabled' ||\n                                            i === 'global' ||\n                                            i === 'dismissible' ||\n                                            i === 'aicon' ||\n                                            i === 'sendnotifications'\n                                        ) && data[i] == 1) {\n                                        affectelement.prop('checked', true);\n                                    } else if (\n                                        (i === 'enabled' ||\n                                            i === 'global' ||\n                                            i === 'dismissible' ||\n                                            i === 'aicon' ||\n                                            i === 'sendnotifications'\n                                        ) && data[i] == 0) {\n                                        affectelement.prop('checked', false);\n                                    } else {\n                                        affectelement.val(data[i]);\n                                    }\n                                }\n                            }\n                            reloadPreview();\n                        }\n                    });\n                });\n\n                // Restore & Permanently delete notifications.\n                mainregion.on('click', '.notifications_restore_table tr > td > form > button[type=submit]', function(e) {\n\n                    e.preventDefault();\n                    var senddata = {}; // Data Object.\n                    senddata.call = 'ajax';\n                    senddata.purpose = '';\n                    senddata.tableaction = '';\n                    senddata.blockid = '';\n\n                    // Check if user wants to restore/delete.\n                    var rattr = $(this).closest('form').attr('data-restore');\n                    var pdattr = $(this).closest('form').attr('data-permdelete');\n                    senddata.blockid = $(this).closest('form').find('[name=blockid]')[0].value;\n\n                    // Check if anchor element has attribute, retrieved from above.\n                    if (typeof rattr !== typeof undefined && rattr !== false) {\n                        senddata.purpose = 'restore';\n                        senddata.tableaction = rattr;\n                    } else if (typeof pdattr !== typeof undefined && pdattr !== false) {\n                        senddata.purpose = 'permdelete';\n                        senddata.tableaction = pdattr;\n                    }\n\n                    var callpath = M.cfg.wwwroot + \"/blocks/advnotifications/pages/process.php?sesskey=\" + M.cfg.sesskey;\n\n                    // Perform tableaction.\n                    $.post(callpath, senddata).fail(function() {\n                        console.error(\"No 'restore/permdelete' response received.\");\n                    }).done(function(data) {\n                        data = JSON.parse(data);\n\n                        // User deleted/restored notification.\n                        // Object 'done' is returned for both restore & delete.\n                        if (parseInt(data.done, 10) > 0) {\n                            $('#tr' + senddata.purpose + data.done).closest(\"tr\").fadeOut(250, function() {\n                                $(this).remove();\n                            });\n                        }\n                    });\n                });\n\n                // Clear form.\n                addregion.on('click', '#add_notification_cancel', function(e) {\n                    e.preventDefault();\n                    clearForm();\n                });\n\n                // Managing more notifications.\n                mainregion.on('submit', '#add_notification_form', function(e) {\n                    e.preventDefault();\n                    var status = $('#add_notification_status');\n                    var form = $('#add_notification_form');\n\n                    refreshRequired();\n                    if (!checkRequired()) {\n                        // Stop if required fields are not supplied.\n                        return;\n                    }\n\n                    status.show();\n\n                    var senddata = $(this).serialize(); // Data Object.\n\n                    var callpath = M.cfg.wwwroot + \"/blocks/advnotifications/pages/process.php\";\n\n                    // Perform tableaction.\n                    $.post(callpath, senddata).fail(function(data) {\n                        console.error(\"No 'add' response received.\");\n\n                        var error = data.responseJSON.error;\n\n                        for (var i in error) {\n                            if (error.hasOwnProperty(i)) {\n                                var sfield = form.find('select[name=' + error[i] + ']');\n                                sfield.addClass('requiredfield');\n                                $(\n                                    '<strong class=\"requiredfield\"><em>' + strings.req + '</em></strong>'\n                                ).insertAfter(sfield[0].nextSibling);\n                            }\n                        }\n\n                        status.hide();\n                    }).done(function() {\n                        // User saved notification.\n                        status.find('.saving').hide();\n                        status.find('.done').show();\n\n                        // Clear Form.\n                        clearForm();\n\n                        setTimeout(function() {\n                            status.fadeOut(function() {\n                                status.find('.done').hide();\n                                status.find('.saving').show();\n                            });\n                        }, 1500);\n\n                        $('#advnotifications_table_wrapper').load('# #advnotifications_table_wrapper > *');\n                    });\n                });\n\n                // LIVE PREVIEW.\n                // Dynamically update preview alert as user changes textbox content.\n                addregion.on('input propertychange paste', '#add_notification_title, #add_notification_message', function() {\n                    reloadPreview();\n                });\n\n                // Dynamically update preview alert type.\n                $('#add_notification_type').on('change', function() {\n                    reloadPreview();\n                });\n\n                $('#add_notification_dismissible').on('change', function() {\n                    // Checking specifically whether ticked/checked or not to ensure it's displayed correctly (not toggling).\n                    reloadPreview();\n                });\n\n                $('#add_notification_aicon').on('change', function() {\n                    // Checking specifically whether ticked/checked or not to ensure it's displayed correctly (not toggling).\n                    reloadPreview();\n                });\n\n                // Check if preview is displaying correct (Update it).\n                var reloadPreview = function() {\n                    // Update title.\n                    var title = addregion.find('#add_notification_title');\n                    if (title.val().length > 0) {\n                        addregion.find('.preview-title')[0].innerHTML = title.val();\n                    } else {\n                        addregion.find('.preview-title')[0].innerHTML = strings.title;\n                    }\n\n                    // Update message.\n                    var message = addregion.find('#add_notification_message');\n                    if (message.val().length > 0) {\n                        addregion.find('.preview-message')[0].innerHTML = message.val();\n                    } else {\n                        addregion.find('.preview-message')[0].innerHTML = strings.message;\n                    }\n\n                    // Check notification type.\n                    var alerttype = $('#add_notification_type').val();\n                    var previewalert = $('#add_notification_wrapper_id .preview-alert');\n\n                    // Clear existing classes.\n                    previewalert.removeClass('alert-info alert-success alert-danger alert-warning announcement');\n\n                    // Special check for announcement type.\n                    if (alerttype === 'announcement') {\n                        previewalert.addClass(alerttype);\n                        alerttype = 'info';\n                    }\n\n                    // If anything unexpected, set to info type.\n                    if (alerttype !== 'info' && alerttype !== 'success' && alerttype !== 'warning' && alerttype !== 'danger') {\n                        alerttype = 'info';\n                    }\n\n                    // Add type of alert class.\n                    previewalert.addClass('alert-' + alerttype);\n\n                    $('.preview-aicon').find('> img').attr('src', M.util.image_url(alerttype, 'block_advnotifications'));\n\n                    // Check if dismissable.\n                    if (!$('#add_notification_dismissible')[0].checked) {\n                        $('.preview-alert-dismissible').hide();\n                        previewalert.removeClass('dismissible');\n                    } else {\n                        $('.preview-alert-dismissible').show();\n                        previewalert.addClass('dismissible');\n                    }\n\n                    // Check if icon should be shown.\n                    if (!$('#add_notification_aicon')[0].checked) {\n                        $('.preview-aicon').hide();\n                        previewalert.removeClass('aicon');\n                    } else {\n                        $('.preview-aicon').show();\n                        previewalert.addClass('aicon');\n                    }\n                };\n\n                var init = function() {\n                    // Get strings.\n                    var senddata = {}; // Data Object.\n                    senddata.call = 'ajax';\n                    senddata.purpose = 'strings';\n\n                    var callpath = M.cfg.wwwroot + \"/blocks/advnotifications/pages/process.php?sesskey=\" + M.cfg.sesskey;\n\n                    $.post(callpath, senddata).fail(function() {\n                        console.error(\"No 'strings' response received.\");\n                    }).done(function(data) {\n                        // TODO: ONLY DO THIS IF AJAX SUCCESSFUL - don't render with English first?).\n                        // Store strings and update preview.\n                        strings = data;\n                    }).always(function() {\n                        // Always prepend live preview. Use langstrings if AJAX successful, otherwise use strings declared at top.\n                        refreshPreview();\n                    });\n\n                    // JS is enabled, so we can use AJAX in the new notification form.\n                    $('#add_notification_form').append(\n                        '<input type=\"hidden\" id=\"add_notification_call\" name=\"call\" value=\"ajax\"/>'\n                    );\n                };\n\n                // Shiny new and fresh preview.\n                var refreshPreview = function() {\n                    var previewelem = $('#notification_preview_wrapper');\n                    var previewdom =\n                        '<div id=\"notification_preview_wrapper\">' +\n                            '<strong>' + strings.preview + '</strong><br>' +\n                            '<div class=\"alert alert-info preview-alert\">' +\n                                '<div class=\"preview-aicon\" style=\"display: none;\">' +\n                                    '<img src=\"' + M.util.image_url('info', 'block_advnotifications') + '\" />' +\n                                '</div>' +\n                                '<strong class=\"preview-title\">' + strings.title + '</strong> ' +\n                                '<div class=\"preview-message\">' + strings.message + '</div> ' +\n                                '<div class=\"preview-alert-dismissible\" style=\"display: none;\"><strong>&times;</strong></div>' +\n                            '</div>' +\n                        '</div>';\n\n                    // If it exists already, remove before adding again.\n                    if (previewelem.length > 0) {\n                        previewelem.remove();\n                        // Don't slide in.\n                        $(previewdom).prependTo($(addregion));\n                    } else {\n                        // Slide in.\n                        $(previewdom).prependTo($(addregion)).hide().slideDown();\n                    }\n                };\n\n                var checkRequired = function() {\n                    var disselopt = $('#add_notification_form select option:selected:disabled');\n\n                    for (var opt in disselopt) {\n                        if (disselopt.hasOwnProperty(opt)) {\n                            if ($(disselopt[opt]).prop('disabled')) {\n                                $(disselopt[opt]).closest('select').addClass('requiredfield');\n                                $('<strong class=\"requiredfield\"><em>' + strings.req + '</em></strong>')\n                                    .insertAfter($(disselopt[opt]).closest('select')[0].nextSibling);\n\n                                return false;\n                            }\n                        }\n                    }\n                    return true;\n                };\n\n                var refreshRequired = function() {\n                    $('select.requiredfield').removeClass('requiredfield');\n                    $('strong.requiredfield').remove();\n                };\n\n                var clearForm = function() {\n                    $('#add_notification_form')[0].reset();\n                    refreshRequired();\n                    refreshPreview();\n\n                    // Change save button back to normal.\n                    var savebutton = $('#add_notification_save');\n                    savebutton.removeClass('update');\n                    $('#add_notification_id').remove();\n                    $('#add_notification_purpose').val('add');\n\n                    savebutton.val(strings.save);\n                };\n\n                init();\n            });\n        }\n    };\n});\n"],"file":"custom.min.js"}